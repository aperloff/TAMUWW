void QuadrantMethod() {
	TCut Acut = "METLV[0].Pt()<=35.0 && METLV[0].Pt()>=25.0 && lLV[0].lpfIso>0.2 && lLV[0].lpfIso<2.0 && lLV[0].leptonCat==2";
	TCut Bcut = "METLV[0].Pt()>35.0 && lLV[0].lpfIso>0.2 && lLV[0].lpfIso<2.0 && lLV[0].leptonCat==2";
	TCut Ccut = "METLV[0].Pt()<=35.0 && METLV[0].Pt()>=25.0 && lLV[0].lpfIso<0.2 && lLV[0].leptonCat==2";
	TCut Scut = "METLV[0].Pt()>35.0 && lLV[0].lpfIso<0.2 && lLV[0].leptonCat==2";

	TString drawString = "lLV[0].Pt()>>";
	TString optionString = "goff";

	cout << "Doing WJets_Full ... ";
	TFile* wFile = new TFile("/uscms_data/d2/aperloff/Summer12ME8TeV/MEInput/WJets_Full.root");PS->cd();
	TH1D* Sw = new TH1D("Sw","Sw",200,0,1000); Sw->Sumw2();
	jets2p->Draw(drawString+"Sw",Scut,optionString);
	Sw->Scale(37509.0 * 19128.0 / 69122011.0);
	cout << "DONE" << endl << "Doing WW ... ";
	TFile* wwFile = new TFile("/uscms_data/d2/aperloff/Summer12ME8TeV/MEInput/WW.root");PS->cd();
	TH1D* Sww = new TH1D("Sww","Sww",200,0,1000); Sww->Sumw2();
	jets2p->Draw(drawString+"Sww",Scut,optionString);
	Sww->Scale(54.838 * 19128.0 / 9450414.0);
	cout << "DONE" << endl << "Doing WZ ... ";
	TFile* wzFile = new TFile("/uscms_data/d2/aperloff/Summer12ME8TeV/MEInput/WZ.root");PS->cd();
	TH1D* Swz = new TH1D("Swz","Swz",200,0,1000); Swz->Sumw2();
	jets2p->Draw(drawString+"Swz",Scut,optionString);
	Swz->Scale(33.21 * 19128.0 / 10000267.0);
	cout << "DONE" << endl << "Doing DYJets ... ";
	TFile* zFile = new TFile("/uscms_data/d2/aperloff/Summer12ME8TeV/MEInput/DYJets.root");PS->cd();
	TH1D* Sz = new TH1D("Sz","Sz",200,0,1000); Sz->Sumw2();
	jets2p->Draw(drawString+"Sz",Scut,optionString);
	Sz->Scale(3503.71 * 19128.0 / 30209426.0);
	cout << "DONE" << endl << "Doing TTbar ... ";
	TFile* ttFile = new TFile("/uscms_data/d2/aperloff/Summer12ME8TeV/MEInput/TTbar.root");PS->cd();
	TH1D* Stt = new TH1D("Stt","Stt",200,0,1000); Stt->Sumw2();
	jets2p->Draw(drawString+"Stt",Scut,optionString);
	Stt->Scale(225.197 * 19128.0 / 6893735.0);
	cout << "DONE" << endl << "Doing STopS_T ... ";
	TFile* ststFile = new TFile("/uscms_data/d2/aperloff/Summer12ME8TeV/MEInput/STopS_T.root");PS->cd();
	TH1D* Sstst = new TH1D("Sstst","Sstst",200,0,1000); Sstst->Sumw2();
	jets2p->Draw(drawString+"Sstst",Scut,optionString);
	Sstst->Scale(3.790 * 19128.0 / 259960.0);
	cout << "DONE" << endl << "Doing STopS_Tbar ... ";
	TFile* ststbFile = new TFile("/uscms_data/d2/aperloff/Summer12ME8TeV/MEInput/STopS_Tbar.root");PS->cd();
	TH1D* Sststb = new TH1D("Sststb","Sststb",200,0,1000); Sststb->Sumw2();
	jets2p->Draw(drawString+"Sststb",Scut,optionString);
	Sststb->Scale(1.760 * 19128.0 / 139974.0);
	cout << "DONE" << endl << "Doing STopTW_T ... ";
	TFile* sttwtFile = new TFile("/uscms_data/d2/aperloff/Summer12ME8TeV/MEInput/STopTW_T.root");PS->cd();
	TH1D* Ssttwt = new TH1D("Ssttwt","Ssttwt",200,0,1000); Ssttwt->Sumw2();
	jets2p->Draw(drawString+"Ssttwt",Scut,optionString);
	Ssttwt->Scale(11.10 * 19128.0 / 437657.0);
	cout << "DONE" << endl << "Doing STopTW_Tbar ... ";
	TFile* sttwtbFile = new TFile("/uscms_data/d2/aperloff/Summer12ME8TeV/MEInput/STopTW_Tbar.root");PS->cd();
	TH1D* Ssttwtb = new TH1D("Ssttwtb","Ssttwtb",200,0,1000); Ssttwtb->Sumw2();
	jets2p->Draw(drawString+"Ssttwtb",Scut,optionString);
	Ssttwtb->Scale(11.10 * 19128.0 / 433458.0);
	cout << "DONE" << endl << "Doing STopT_T ... ";
	TFile* stttFile = new TFile("/uscms_data/d2/aperloff/Summer12ME8TeV/MEInput/STopT_T.root");PS->cd();
	TH1D* Ssttt = new TH1D("Ssttt","Ssttt",200,0,1000); Ssttt->Sumw2();
	jets2p->Draw(drawString+"Ssttt",Scut,optionString);
	Ssttt->Scale(56.40 * 19128.0 / 3758221.0);
	cout << "DONE" << endl << "Doing STopT_Tbar ... ";
	TFile* stttbFile = new TFile("/uscms_data/d2/aperloff/Summer12ME8TeV/MEInput/STopT_Tbar.root");PS->cd();
	TH1D* Sstttb = new TH1D("Sstttb","Sstttb",200,0,1000); Sstttb->Sumw2();
	jets2p->Draw(drawString+"Sstttb",Scut,optionString);
	Sstttb->Scale(30.70 * 19128.0 / 1935066.0);
	cout << "DONE" << endl << "Doing SingleEl_Full ... ";
	TFile* qFile = new TFile("/uscms_data/d2/aperloff/Summer12ME8TeV/MEInput/SingleEl_Full.root");PS->cd();
	TH1D* A = new TH1D("A","A",200,0,1000); A->Sumw2();
	TH1D* B = new TH1D("B","B",200,0,1000); B->Sumw2();
	TH1D* C = new TH1D("C","C",200,0,1000); C->Sumw2();
	TH1D* S = new TH1D("S","S",200,0,1000); S->Sumw2();
	jets2p->Draw(drawString+"A",Acut,optionString);
	jets2p->Draw(drawString+"B",Bcut,optionString);
	jets2p->Draw(drawString+"C",Ccut,optionString);
	jets2p->Draw(drawString+"S",Scut,optionString);
	cout << "DONE" << endl;

	C->Divide(A);

	TString ofileName = "QCDWeight_electron_QuadrantMethod.root";
	cout << "Saving C/A weights to file " << ofileName << endl;
	TFile* ofile = new TFile(ofileName,"RECREATE");
	C->SetNameTitle("QCDWeight_electron","");
	C->Write();
	cout << "DONE" << endl;

	B->Multiply(C);
	S->Add(Sw,-1.0);
	S->Add(Sww,-1.0);
	S->Add(Swz,-1.0);
	S->Add(Stt,-1.0);
	S->Add(Sz,-1.0);
	S->Add(Sstst,-1.0);
	S->Add(Sststb,-1.0);
	S->Add(Ssttwt,-1.0);
	S->Add(Ssttwtb,-1.0);
	S->Add(Ssttt,-1.0);
	S->Add(Sstttb,-1.0);
	B->Scale(S->Integral()/B->Integral());
	B->SetLineColor(kRed);
	S->SetLineColor(kBlue);
	S->GetXaxis()->SetTitle("p_{T}^{Lepton}");
	S->GetXaxis()->SetRangeUser(0,200);
	S->GetYaxis()->SetTitle("Events / 5 GeV");
	S->SetTitle("S =? B x #frac{C}{A}");
	S->Draw();
	B->Draw("same");
	TLegend* leg = new TLegend(0.7,0.4,0.9,0.6);
	leg->AddEntry(S,"Signal","l");
	leg->AddEntry(B,"B x #frac{C}{A}","l");
	leg->Draw();

	cout << "Saving signal to Bx(C/A) comparison canvas to file " << ofileName << endl;
	c1->Write();
	cout << "DONE" << endl;

	cout << "Closing file " << ofileName << endl;
	ofile->Close();
	cout << "DONE" << endl;
}
void QuadrantMethodQCDMC() {
	//TCut Acut = "lLV[0].emvaTrig<=0.95 && lLV[0].lpfIso>0.3 && lLV[0].lpfIso<2.0 && lLV[0].leptonCat==2";
	//TCut Bcut = "lLV[0].emvaTrig>0.95 && lLV[0].lpfIso>0.3 && lLV[0].lpfIso<2.0 && lLV[0].leptonCat==2";
	//TCut Ccut = "lLV[0].emvaTrig<=0.95 && lLV[0].lpfIso<0.2 && lLV[0].leptonCat==2";
	//TCut Scut = "lLV[0].emvaTrig>0.95 && lLV[0].lpfIso<0.2 && lLV[0].leptonCat==2";

	TCut Acut = "METLV[0].Pt()<=30.0 && METLV[0].Pt()>=25.0 && lLV[0].lpfIso>0.3 && lLV[0].lpfIso<2.0 && lLV[0].leptonCat==2";
	TCut Bcut = "METLV[0].Pt()>30.0 && lLV[0].lpfIso>0.3 && lLV[0].lpfIso<2.0 && lLV[0].leptonCat==2";
	TCut Ccut = "METLV[0].Pt()<=30.0 && METLV[0].Pt()>=25.0 && lLV[0].lpfIso<0.2 && lLV[0].leptonCat==2";
	TCut Scut = "METLV[0].Pt()>30.0 && lLV[0].lpfIso<0.2 && lLV[0].leptonCat==2";

	TString drawString = "lLV[0].Pt()>>";
	TString optionString = "goff";

	cout << "Doing QCD_EM_20to30 ... ";
	TFile* qFile20to30 = new TFile("/uscms_data/d2/aperloff/Summer12ME8TeV/MEInput/QCD_EM_20to30.root");PS->cd();
	TH1D* A20to30 = new TH1D("A20to30","A20to30",200,0,1000);
	TH1D* B20to30 = new TH1D("B20to30","B20to30",200,0,1000);
	TH1D* C20to30 = new TH1D("C20to30","C20to30",200,0,1000);
	TH1D* S20to30 = new TH1D("S20to30","S20to30",200,0,1000);
	A20to30->Sumw2();
	B20to30->Sumw2();
	C20to30->Sumw2();
	S20to30->Sumw2();
	jets2p->Draw(drawString+"A20to30",Acut,optionString);
	jets2p->Draw(drawString+"B20to30",Bcut,optionString);
	jets2p->Draw(drawString+"C20to30",Ccut,optionString);
	jets2p->Draw(drawString+"S20to30",Scut,optionString);
	A20to30->Scale(288600000 * 19128.0 / 35040695);
	B20to30->Scale(288600000 * 19128.0 / 35040695);
	C20to30->Scale(288600000 * 19128.0 / 35040695);
	S20to30->Scale(288600000 * 19128.0 / 35040695);
	cout << "DONE" << endl;

	cout << "Doing QCD_EM_30to80 ... ";
	TFile* qFile30to80 = new TFile("/uscms_data/d2/aperloff/Summer12ME8TeV/MEInput/QCD_EM_30to80.root");PS->cd();
	TH1D* A30to80 = new TH1D("A30to80","A30to80",200,0,1000);
	TH1D* B30to80 = new TH1D("B30to80","B30to80",200,0,1000);
	TH1D* C30to80 = new TH1D("C30to80","C30to80",200,0,1000);
	TH1D* S30to80 = new TH1D("S30to80","S30to80",200,0,1000);
	A30to80->Sumw2();
	B30to80->Sumw2();
	C30to80->Sumw2();
	S30to80->Sumw2();
	jets2p->Draw(drawString+"A30to80",Acut,optionString);
	jets2p->Draw(drawString+"B30to80",Bcut,optionString);
	jets2p->Draw(drawString+"C30to80",Ccut,optionString);
	jets2p->Draw(drawString+"S30to80",Scut,optionString);
	A30to80->Scale(74330000 * 19128.0 / 33088888);
	B30to80->Scale(74330000 * 19128.0 / 33088888);
	C30to80->Scale(74330000 * 19128.0 / 33088888);
	S30to80->Scale(74330000 * 19128.0 / 33088888);
	cout << "DONE" << endl;

	cout << "Doing QCD_EM_80to170 ... ";
	TFile* qFile80to170 = new TFile("/uscms_data/d2/aperloff/Summer12ME8TeV/MEInput/QCD_EM_80to170.root");PS->cd();
	TH1D* A80to170 = new TH1D("A80to170","A80to170",200,0,1000);
	TH1D* B80to170 = new TH1D("B80to170","B80to170",200,0,1000);
	TH1D* C80to170 = new TH1D("C80to170","C80to170",200,0,1000);
	TH1D* S80to170 = new TH1D("S80to170","S80to170",200,0,1000);
	A80to170->Sumw2();
	B80to170->Sumw2();
	C80to170->Sumw2();
	S80to170->Sumw2();
	jets2p->Draw(drawString+"A80to170",Acut,optionString);
	jets2p->Draw(drawString+"B80to170",Bcut,optionString);
	jets2p->Draw(drawString+"C80to170",Ccut,optionString);
	jets2p->Draw(drawString+"S80to170",Scut,optionString);
	A80to170->Scale(1191000 * 19128.0 / 34542763);
	B80to170->Scale(1191000 * 19128.0 / 34542763);
	C80to170->Scale(1191000 * 19128.0 / 34542763);
	S80to170->Scale(1191000 * 19128.0 / 34542763);
	cout << "DONE" << endl;

	cout << "Doing QCD_EM_170to250 ... ";
	TFile* qFile170to250 = new TFile("/uscms_data/d2/aperloff/Summer12ME8TeV/MEInput/QCD_EM_170to250.root");PS->cd();
	TH1D* A170to250 = new TH1D("A170to250","A170to250",200,0,1000);
	TH1D* B170to250 = new TH1D("B170to250","B170to250",200,0,1000);
	TH1D* C170to250 = new TH1D("C170to250","C170to250",200,0,1000);
	TH1D* S170to250 = new TH1D("S170to250","S170to250",200,0,1000);
	A170to250->Sumw2();
	B170to250->Sumw2();
	C170to250->Sumw2();
	S170to250->Sumw2();
	jets2p->Draw(drawString+"A170to250",Acut,optionString);
	jets2p->Draw(drawString+"B170to250",Bcut,optionString);
	jets2p->Draw(drawString+"C170to250",Ccut,optionString);
	jets2p->Draw(drawString+"S170to250",Scut,optionString);
	A170to250->Scale(30990 * 19128.0 / 31697066);
	B170to250->Scale(30990 * 19128.0 / 31697066);
	C170to250->Scale(30990 * 19128.0 / 31697066);
	S170to250->Scale(30990 * 19128.0 / 31697066);
	cout << "DONE" << endl;

	cout << "Doing QCD_EM_250to350 ... ";
	TFile* qFile250to350 = new TFile("/uscms_data/d2/aperloff/Summer12ME8TeV/MEInput/QCD_EM_250to350.root");PS->cd();
	TH1D* A250to350 = new TH1D("A250to350","A250to350",200,0,1000);
	TH1D* B250to350 = new TH1D("B250to350","B250to350",200,0,1000);
	TH1D* C250to350 = new TH1D("C250to350","C250to350",200,0,1000);
	TH1D* S250to350 = new TH1D("S250to350","S250to350",200,0,1000);
	A250to350->Sumw2();
	B250to350->Sumw2();
	C250to350->Sumw2();
	S250to350->Sumw2();
	jets2p->Draw(drawString+"A250to350",Acut,optionString);
	jets2p->Draw(drawString+"B250to350",Bcut,optionString);
	jets2p->Draw(drawString+"C250to350",Ccut,optionString);
	jets2p->Draw(drawString+"S250to350",Scut,optionString);
	A250to350->Scale(4250 * 19128.0 / 34611322);
	B250to350->Scale(4250 * 19128.0 / 34611322);
	C250to350->Scale(4250 * 19128.0 / 34611322);
	S250to350->Scale(4250 * 19128.0 / 34611322);
	cout << "DONE" << endl;

	cout << "Doing QCD_EM_350 ... ";
	TFile* qFile350 = new TFile("/uscms_data/d2/aperloff/Summer12ME8TeV/MEInput/QCD_EM_350.root");PS->cd();
	TH1D* A350 = new TH1D("A350","A350",200,0,1000);
	TH1D* B350 = new TH1D("B350","B350",200,0,1000);
	TH1D* C350 = new TH1D("C350","C350",200,0,1000);
	TH1D* S350 = new TH1D("S350","S350",200,0,1000);
	A350->Sumw2();
	B350->Sumw2();
	C350->Sumw2();
	S350->Sumw2();
	jets2p->Draw(drawString+"A350",Acut,optionString);
	jets2p->Draw(drawString+"B350",Bcut,optionString);
	jets2p->Draw(drawString+"C350",Ccut,optionString);
	jets2p->Draw(drawString+"S350",Scut,optionString);
	A350->Scale(810 * 19128.0 / 34080562);
	B350->Scale(810 * 19128.0 / 34080562);
	C350->Scale(810 * 19128.0 / 34080562);
	S350->Scale(810 * 19128.0 / 34080562);	
	cout << "DONE" << endl;


	TH1D* A = new TH1D("A","A",200,0,1000);
	TH1D* B = new TH1D("B","B",200,0,1000);
	TH1D* C = new TH1D("C","C",200,0,1000);
	TH1D* S = new TH1D("S","S",200,0,1000);

	cout << "Summing histograms ...";	
	A->Add(A20to30);
	A->Add(A30to80);
	A->Add(A80to170);
	A->Add(A170to250);
	A->Add(A250to350);
	A->Add(A350);

	B->Add(B20to30);
	B->Add(B30to80);
	B->Add(B80to170);
	B->Add(B170to250);
	B->Add(B250to350);
	B->Add(B350);

	C->Add(C20to30);
	C->Add(C30to80);
	C->Add(C80to170);
	C->Add(C170to250);
	C->Add(C250to350);
	C->Add(C350);

	S->Add(S20to30);
	S->Add(S30to80);
	S->Add(S80to170);
	S->Add(S170to250);
	S->Add(S250to350);
	S->Add(S350);
	cout << "DONE" << endl;

	C->Divide(A);
	B->Multiply(C);
	B->Scale(S->Integral()/B->Integral());
	B->SetLineColor(kRed);
	S->SetLineColor(kBlue);
	S->SetLineWidth(3);
	S->GetXaxis()->SetTitle("p_{T}^{Lepton}");
	S->GetXaxis()->SetRangeUser(0,200);
	S->GetYaxis()->SetTitle("Events / 5 GeV");
	S->SetTitle("S =? B x #frac{C}{A}");
	S->Draw();
	B->Draw("same");
	TLegend* leg = new TLegend(0.7,0.4,0.9,0.6);
	leg->AddEntry(S,"Signal","l");
	leg->AddEntry(B,"B x #frac{C}{A}","l");
	leg->Draw();
}

void QuadrantMethodMC() {
	//TCut Acut = "lLV[0].emvaTrig<=0.95 && lLV[0].lpfIso>0.3 && lLV[0].lpfIso<2.0 && lLV[0].leptonCat==2";
	//TCut Bcut = "lLV[0].emvaTrig>0.95 && lLV[0].lpfIso>0.3 && lLV[0].lpfIso<2.0 && lLV[0].leptonCat==2";
	//TCut Ccut = "lLV[0].emvaTrig<=0.95 && lLV[0].lpfIso<0.2 && lLV[0].leptonCat==2";
	//TCut Scut = "lLV[0].emvaTrig>0.95 && lLV[0].lpfIso<0.2 && lLV[0].leptonCat==2";

	TCut Acut = "METLV[0].Pt()<=35.0 && METLV[0].Pt()>=25.0 && lLV[0].lpfIso>0.2 && lLV[0].lpfIso<2.0 && lLV[0].leptonCat==2";
	TCut Bcut = "METLV[0].Pt()>35.0 && lLV[0].lpfIso>0.2 && lLV[0].lpfIso<2.0 && lLV[0].leptonCat==2";
	TCut Ccut = "METLV[0].Pt()<=35.0 && METLV[0].Pt()>=25.0 && lLV[0].lpfIso<0.2 && lLV[0].leptonCat==2";
	TCut Scut = "METLV[0].Pt()>35.0 && lLV[0].lpfIso<0.2 && lLV[0].leptonCat==2";

	TString drawString = "lLV[0].Pt()>>";
	TString optionString = "goff";

	cout << "Doing WJets ... ";
	TFile* qFile20to30 = new TFile("/uscms_data/d2/aperloff/Summer12ME8TeV/MEInput/WJets_Full.root");PS->cd();
	TH1D* A = new TH1D("A","A",200,0,1000);
	TH1D* B = new TH1D("B","B",200,0,1000);
	TH1D* C = new TH1D("C","C",200,0,1000);
	TH1D* S = new TH1D("S","S",200,0,1000);
	A->Sumw2();
	B->Sumw2();
	C->Sumw2();
	S->Sumw2();
	jets2p->Draw(drawString+"A",Acut,optionString);
	jets2p->Draw(drawString+"B",Bcut,optionString);
	jets2p->Draw(drawString+"C",Ccut,optionString);
	jets2p->Draw(drawString+"S",Scut,optionString);
	cout << "DONE" << endl;

	C->Divide(A);
	B->Multiply(C);
	B->Scale(S->Integral()/B->Integral());
	B->SetLineColor(kRed);
	S->SetLineColor(kBlue);
	S->SetLineWidth(3);
	S->GetXaxis()->SetTitle("p_{T}^{Lepton}");
	S->GetXaxis()->SetRangeUser(0,200);
	S->GetYaxis()->SetTitle("Events / 5 GeV");
	S->SetTitle("S =? B x #frac{C}{A}");
	S->Draw();
	B->Draw("same");
	TLegend* leg = new TLegend(0.7,0.4,0.9,0.6);
	leg->AddEntry(S,"Signal","l");
	leg->AddEntry(B,"B x #frac{C}{A}","l");
	leg->Draw();
}